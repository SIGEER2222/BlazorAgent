数据存储与一致性（首版模板）

目标
- 明确数据模型与存储选型，保证一致性与可演进。

现状
- M1 使用内存仓库：`src/libs/factory/Factory.Infrastructure/Repositories/InMemoryCatalogRepository.cs:1-30`、`src/libs/factory/Factory.Infrastructure/Repositories/InMemoryBlueprintRepository.cs:1-16`。

选型建议
- 关系型（SQLite）+ ORM（SqlSugar）；目录与配方采用简化表，Inputs/Outputs 使用 JSON 存储。
- 时序/诊断数据采用内存环形队列采样（后续可迁移至表）。

核心表（当前实现）
- `ItemEntity(Id PK, Name, Category, StackSize)`
- `RecipeEntity(Id PK, InputsJson, OutputsJson, TimeSeconds, PowerKw)`
- 后续：`Lines/Machines`、`LogisticsEdges`、`PowerDomains`、`Orders/Plans` 等。

一致性与事务
- 导入 Replace 采用覆盖写入保证视图一致；增量 Add 幂等按 Id 唯一。
- 引擎状态的快照与重放：保留 `inventory/produced/energy` 指标端点，必要时持久化快照。

备份与迁移
- `ConnectionStrings:FactoryDb` 默认 `Data Source=App_Data/factory.db`；启动时自动建表。
- 迁移：SqlSugar CodeFirst；备份 App_Data 与 CSV 导出端点（M5）。
